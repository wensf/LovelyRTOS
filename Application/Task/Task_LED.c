
#include "stm32f4xx.h"

#include "OSCore.h"
#include "OSTask.h"
#include "Task_LED.h"
#include "Draw.h"

void LED_GPIO_Init(void)
{
	GPIO_InitTypeDef GPIO_InitStructure; 
	RCC_AHB1PeriphClockCmd ( LED1_CLK, ENABLE); 			
	
	GPIO_InitStructure.GPIO_Mode  = GPIO_Mode_OUT;   
	GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;   
	GPIO_InitStructure.GPIO_PuPd  = GPIO_PuPd_UP;	 
	GPIO_InitStructure.GPIO_Speed = GPIO_Speed_2MHz;
	
	GPIO_InitStructure.GPIO_Pin = LED1_PIN;	 
	GPIO_Init(LED1_PORT, &GPIO_InitStructure);		
	
	GPIO_ResetBits(LED1_PORT,LED1_PIN);  
}

unsigned long Task_LED_tick;

const unsigned char Font_14x32[][56] = { 
{0x00,0x00,0x00,0x00,0xF0,0xFF,0xFF,0x0F,0xFC,0xFF,0xFF,0x3F,0xFE,0xFF,0xFF,0x7F,0x0E,0x00,0x00,0x70,0x07,0x00,0x00,0xE0,0x07,0x00,0x00,0xE0,0x07,0x00,0x00,0xE0,0x07,0x00,0x00,0xE0,0x07,0x00,0x00,0xE0,0x0E,0x00,0x00,0x70,0xFE,0xFF,0xFF,0x7F,0xFC,0xFF,0xFF,0x3F,0xF0,0xFF,0xFF,0x0F},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\0.BMP",0*/  
{0x00,0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x0C,0x00,0x00,0x00,0x0E,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\1.BMP",0*/
{0x00,0x00,0x00,0x00,0x30,0x00,0x00,0xE0,0x3C,0x00,0x00,0xF8,0x3E,0x00,0x00,0xFE,0x0E,0x00,0x80,0xFF,0x07,0x00,0xE0,0xEF,0x07,0x00,0xF8,0xE3,0x07,0x00,0xFE,0xE0,0x07,0x80,0x3F,0xE0,0x07,0xE0,0x0F,0xE0,0x0E,0xF0,0x03,0xE0,0xFE,0xFF,0x00,0xE0,0xFC,0x3F,0x00,0xE0,0xF0,0x0F,0x00,0x00},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\2.BMP",0*/ 
{0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x0C,0x3C,0x00,0x00,0x3C,0x3E,0x00,0x00,0x7C,0x0E,0xC0,0x01,0x70,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xE0,0x03,0xE0,0x0E,0xF0,0x07,0x70,0xFE,0x7F,0xFF,0x7F,0xFC,0x3F,0xFE,0x3F,0xF0,0x1F,0xFC,0x0F},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\3.bmp",0*/ 
{0x00,0x00,0x00,0x00,0x00,0x00,0x1E,0x00,0x00,0x80,0x1F,0x00,0x00,0xE0,0x1F,0x00,0x00,0xF8,0x1F,0x00,0x00,0xFE,0x1C,0x00,0x80,0x3F,0x1C,0x00,0xE0,0x0F,0x1C,0x00,0xF8,0x03,0x1C,0x00,0xFE,0x00,0x1C,0x00,0xFF,0xFF,0xFF,0x7F,0xFF,0xFF,0xFF,0x7F,0xFF,0xFF,0xFF,0x7F,0x00,0x00,0x1C,0x00},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\4.BMP",0*/  
{0x00,0x00,0x00,0x00,0xFC,0x7F,0x80,0x1F,0xFE,0xFF,0x80,0x3F,0xFF,0xFF,0x81,0x7F,0x07,0xE0,0x01,0xF0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x03,0xF0,0x07,0xC0,0xFF,0x7F,0x07,0x80,0xFF,0x3F,0x00,0x00,0xFF,0x1F},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\5.BMP",0*/ 
{0x00,0x00,0x00,0x00,0xFC,0xFF,0xFF,0x1F,0xFE,0xFF,0xFF,0x3F,0xFF,0xFF,0xFF,0x7F,0x07,0xC0,0x01,0x70,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x0F,0xC0,0x03,0x70,0x1F,0xC0,0xFF,0x7F,0x1E,0x80,0xFF,0x3F,0x1C,0x00,0xFF,0x1F},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\6.BMP",0*/ 
{0x00,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFE,0xFF,0xFF,0xFF,0xFC,0xFF,0xFF,0xFF},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\7.BMP",0*/ 
{0x00,0x00,0x00,0x00,0xF8,0x1F,0xFC,0x1F,0xFC,0x3F,0xFE,0x3F,0xFE,0x7F,0xFF,0x7F,0x0F,0xF0,0x07,0xF0,0x07,0xE0,0x03,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xC0,0x01,0xE0,0x07,0xE0,0x03,0xE0,0x0F,0xF0,0x07,0xF0,0xFE,0x7F,0xFF,0x7F,0xFC,0x3F,0xFE,0x3F,0xF8,0x1F,0xFC,0x1F},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\8.BMP",0*/  
{0x00,0x00,0x00,0x00,0xF8,0xFF,0x00,0x38,0xFC,0xFF,0x01,0x78,0xFE,0xFF,0x03,0xF8,0x0F,0xC0,0x03,0xF0,0x07,0x80,0x03,0xE0,0x07,0x80,0x03,0xE0,0x07,0x80,0x03,0xE0,0x07,0x80,0x03,0xE0,0x07,0xC0,0x03,0xF0,0x0F,0xE0,0x01,0xF8,0xFE,0xFF,0xFF,0x7F,0xFC,0xFF,0xFF,0x3F,0xF8,0xFF,0xFF,0x1F},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\9.BMP",0*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0E,0x1C,0x00,0x00,0x0E,0x1C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"F:\BandAll\HB018\UI_1016\HB018_主界面2\数字14x32(主界面)\冒号.bmp",0*/
};

#include "Task_GUI.h"
#include "MYADC.h"
#include <string.h>

int adc_value;

void Task_LED(void)
{
	LED_GPIO_Init();
	
	int hour = 0;
	int minute = 0;
	int flag = 0;
	
	myADC_Init();
	
	while(1)
	{
		Task_LED_tick++;
		LED1_ON();

		#if 0
		#if 1
		
		memset(fb, 0x00, sizeof(fb));
		DrawUI_Bitmap_Ex( 0, 0, 14, 32, Font_14x32[hour/10], 0x1F<<11|0x3F<<5);  
		DrawUI_Bitmap_Ex(16, 0, 14, 32, Font_14x32[hour%10], 0xFFFF); 
		if ( flag++ & 0x1 )  
		{ 
			DrawUI_Bitmap_Ex(32, 0, 8, 32, Font_14x32[10], 0xFFFF);  
		}  
		DrawUI_Bitmap_Ex(40, 0, 14, 32, Font_14x32[minute/10],  0xFFFF);  
		DrawUI_Bitmap_Ex(56, 0, 14, 32, Font_14x32[minute%10],  0xFFFF);  
		#endif
		OS_Delay(250);
		LED1_OFF();
		OS_Delay(250);

		minute++;
		if ( minute > 59 )
		{
			hour++;
			hour %= 60;
		}
		
		minute %= 60;
		
		
		adc_value = getConvResult();
		#else
		OS_Delay(500);
		#endif
	}	
	
}
